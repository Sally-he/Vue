<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>发布订阅模式</title>
</head>
<body>
    <script>
        class Dep {
            constructor(){
                this.subs = []
            }
            // 增加订阅者
            addSub(sub){
                if(this.subs.indexOf(sub)< 0) {
                    this.subs.push(sub)
                }
            }
            // 通知订阅者
            notify(){
                this.subs.forEach( (sub)=>{
                    sub.updated()
                })
            }
        }
        let num = 0
        const dep = new Dep()
        const sub1 = {
            updated() {
                console.log('sub1 update', ++num)
            }
        }
        const sub2 = {
            updated() {
                console.log('sub2 update', ++num)
            }
        }
        // 新增订阅者
        dep.addSub(sub1)
        dep.addSub(sub2)
        // 通知订阅者
        dep.notify()
    </script>
</body>
</html>